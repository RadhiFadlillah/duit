import{DialogForm}from"./form.min.js";import{i18n}from"../i18n/i18n.min.js";export function DialogFormEntry(){return{view:function(t){let e=t.attrs.title,n=t.attrs.loading,a=t.attrs.accounts,r=t.attrs.entryType,o=t.attrs.defaultValue,i=t.attrs.onAccepted,l=t.attrs.onRejected;"string"!=typeof e&&(e=""),"boolean"!=typeof n&&(n=!1),Array.isArray(a)||(a=[]),"number"!=typeof r&&(r=1),"object"!=typeof o&&(o={}),"function"!=typeof i&&(i=()=>{}),"function"!=typeof l&&(l=()=>{}),r=Math.floor(r),(r<1||r>3)&&(r=1);let c=[{name:"amount",label:i18n("Amount"),type:"float",min:0,required:!0},{name:"date",label:i18n("Entry date"),type:"date",required:!0}];3!==r&&c.unshift({name:"description",label:i18n("Description"),required:!0}),3===r&&c.push({name:"affectedAccountId",label:i18n("Target"),type:"select",required:!0,choices:a.map(t=>({caption:t.name,value:String(t.id)}))});let d=o.date;return null!=d&&""!==d||(o.date=function(t){let e=String(t.getDate()).padStart(2,"0"),n=String(t.getMonth()+1).padStart(2,"0");return`${t.getFullYear()}-${n}-${e}`}(new Date)),c.forEach((t,e)=>{let n=t.name;c[e].value=o[n]||""}),m(DialogForm,{title:e,loading:n,fields:c,onRejected:l,onAccepted(t){t.type=r,t.affectedAccountId=parseInt(t.affectedAccountId,10),i(t)}})}}}