import{Button,LoadingSign}from"./_components.min.js";import{Big}from"../libs/big.min.js";import{mergeObject,formatDate,formatNumber}from"../libs/utils.min.js";export function EntryList(){let t=0;function e(e,n){let a=e.indexOf(n);-1!==a?e.splice(a,1):e.push(n),t=n}function n(e,n){let a=t,o=n;a>o&&(a=n,o=t);for(var r=a;r<=o;r++)-1===e.indexOf(r)&&e.push(r);t=n}return{view:function(t){let a=t.attrs.account,o=t.attrs.entries,r=t.attrs.loading,i=t.attrs.class,c=t.attrs.selection,l=t.attrs.currentPage,s=t.attrs.maxPage,p=t.attrs.onItemClicked,f=t.attrs.onNewClicked,u=t.attrs.onEditClicked,y=t.attrs.onDeleteClicked,d=t.attrs.onPageChanged;"object"!=typeof a&&(a={}),Array.isArray(o)||(o=[]),"boolean"!=typeof r&&(r=!1),"string"!=typeof i&&(i=""),Array.isArray(c)||(c=[]),"number"!=typeof l&&(l=1),"number"!=typeof s&&(s=1),"function"!=typeof p&&(p=()=>{}),"function"!=typeof f&&(f=()=>{}),"function"!=typeof u&&(u=()=>{}),"function"!=typeof y&&(y=()=>{}),"function"!=typeof d&&(d=()=>{});let h="Daftar Entry";if(null!=a){let t=a.name||"",e=a.total||"0";h=`${t}, ${formatNumber(e)}`}let g=[m("p.entry-list__header__title",h)],_={iconOnly:!0,class:"entry-list__header__button"};o.length>0&&!r&&g.unshift(m("input[type=checkbox].entry__check",{checked:c.length===o.length,onclick(){!function(t,e){if(t.length===e)t.splice(0,t.length);else for(var n=0;n<e;n++)-1===t.indexOf(n)&&t.push(n)}(c,o.length)}})),1===c.length&&g.push(m(Button,mergeObject(_,{icon:"fa-pen",caption:"Edit entry",onclick(){u()}}))),c.length>=1&&g.push(m(Button,mergeObject(_,{icon:"fa-trash-alt",caption:"Delete entry",onclick(){y()}}))),g.push(m(Button,mergeObject(_,{icon:"fa-plus-circle",caption:"Entry baru",onclick(){f()}})));let b=m(".entry-list__header",g),k=[];if(r?k.push(m(LoadingSign,{class:"entry-list__loading-sign"})):0===o.length?k.push(m("p.entry-list__empty-message","Belum ada entry terdaftar")):(o.forEach((t,r)=>{let i=o[r-1];null!=i&&t.date===i.date||k.push(m("p.entry__date",formatDate(t.date)));let l="",s=Big(t.amount),p=t.description||"";switch(t.type){case 1:l="entry--income";break;case 2:l="entry--expense",s=s.times(-1);break;case 3:let e="";(a.id||-1)===t.affectedAccountId?(l="entry--income",e=`Masuk dari ${t.account}`):(l="entry--expense",e=`Pindah ke ${t.affectedAccount}`,s=s.times(-1)),p=p||e}let f,u={checked:-1!==c.indexOf(r),onclick(t){t.shiftKey?n(c,r):e(c,r)},onkeydown(t){"Enter"!==t.code&&"NumpadEnter"!==t.code||(t.shiftKey?n(c,r):e(c,r))}};3===t.type&&(f="entry--transfer"),k.push(m(".entry",m("input[type=checkbox].entry__check",u),m("p.entry__description",{class:f},p),m("p.entry__amount",{class:l},formatNumber(s))))}),k.push(m(".entry-list__space"))),s>1){let t={iconOnly:!0,tooltipPosition:"top",class:"entry-list__footer__button"},e={first:!r&&l>2,prev:!r&&l>1,next:!r&&l<s,last:!r&&l<s-1};k.push(m(".entry-list__footer",m(Button,mergeObject(t,{icon:"fa-angle-double-left",caption:"Halaman pertama",enabled:e.first,onclick(){d(1)}})),m(Button,mergeObject(t,{icon:"fa-angle-left",caption:"Halaman sebelumnya",enabled:e.prev,onclick(){d(l-1)}})),m("p.entry-list__footer__page",`${l} / ${s}`),m(Button,mergeObject(t,{icon:"fa-angle-right",caption:"Halaman selanjutnya",enabled:e.next,onclick(){d(l+1)}})),m(Button,mergeObject(t,{icon:"fa-angle-double-right",caption:"Halaman terakhir",enabled:e.last,onclick(){d(s)}}))))}return m(".entry-list",{class:i},[b,k])}}}