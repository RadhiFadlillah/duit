import{Button,LoadingSign}from"./_components.min.js";import{Big}from"../libs/big.min.js";import{mergeObject}from"../libs/utils.min.js";import{i18n,formatDate,formatNumber}from"../i18n/i18n.min.js";export function EntryList(){let t=0;function e(e,n){let i=e.indexOf(n);-1!==i?e.splice(i,1):e.push(n),t=n}function n(e,n){let i=t,o=n;i>o&&(i=n,o=t);for(var r=i;r<=o;r++)-1===e.indexOf(r)&&e.push(r);t=n}return{view:function(t){let i=t.attrs.account,o=t.attrs.entries,r=t.attrs.loading,c=t.attrs.class,a=t.attrs.selection,s=t.attrs.currentPage,l=t.attrs.maxPage,p=t.attrs.onNewClicked,f=t.attrs.onEditClicked,u=t.attrs.onDeleteClicked,y=t.attrs.onBackClicked,g=t.attrs.onPageChanged;"object"!=typeof i&&(i={}),Array.isArray(o)||(o=[]),"boolean"!=typeof r&&(r=!1),"string"!=typeof c&&(c=""),Array.isArray(a)||(a=[]),"number"!=typeof s&&(s=1),"number"!=typeof l&&(l=1),"function"!=typeof p&&(p=()=>{}),"function"!=typeof f&&(f=()=>{}),"function"!=typeof u&&(u=()=>{}),"function"!=typeof y&&(y=()=>{}),"function"!=typeof g&&(g=()=>{});let _=i18n("Entry List");if(null!=i){let t=i.name||"",e=i.total||"0";_=`${t} ${formatNumber(e)}`}let d=[m("p.entry-list__header__title",_)],h={iconOnly:!0,class:"entry-list__header__button"};o.length>0&&!r&&d.unshift(m("input[type=checkbox].entry__check",{checked:a.length===o.length,onclick(){!function(t,e){if(t.length===e)t.splice(0,t.length);else for(var n=0;n<e;n++)-1===t.indexOf(n)&&t.push(n)}(a,o.length)}})),1===a.length&&d.push(m(Button,mergeObject(h,{icon:"fa-pen",caption:i18n("Edit entry"),onclick(){f()}}))),a.length>=1&&d.push(m(Button,mergeObject(h,{icon:"fa-trash-alt",caption:i18n("Delete entry"),onclick(){u()}}))),d.push(m(Button,mergeObject(h,{icon:"fa-plus-circle",caption:i18n("New entry"),onclick(){p()}})));let b=m(".entry-list__header",d),k=[];r?k.push(m(LoadingSign,{class:"entry-list__loading-sign"})):0===o.length?k.push(m("p.entry-list__empty-message",i18n("No entries registered"))):o.forEach((t,r)=>{let c=o[r-1];null!=c&&t.date===c.date||k.push(m("p.entry__date",formatDate(t.date)));let s="",l=Big(t.amount),p=t.description||"";switch(t.type){case 1:s="entry--income";break;case 2:s="entry--expense",l=l.times(-1);break;case 3:let e="";(i.id||-1)===t.affectedAccountId?(s="entry--income",e=i18n("Received from $name").replace("$name",t.account)):(s="entry--expense",e=i18n("Transferred to $name").replace("$name",t.account),l=l.times(-1)),p=p||e}let f,u={checked:-1!==a.indexOf(r),onclick(t){t.shiftKey?n(a,r):e(a,r)},onkeydown(t){"Enter"!==t.code&&"NumpadEnter"!==t.code||(t.shiftKey?n(a,r):e(a,r))}};3===t.type&&(f="entry--transfer"),k.push(m(".entry",m("input[type=checkbox].entry__check",u),m("p.entry__description",{class:f},p),m("p.entry__amount",{class:s},formatNumber(l))))});let O=m(".entry-list__body",k),j=[];if(!r){let t={iconOnly:!0,tooltipPosition:"top",class:"entry-list__footer__button"},e={first:!r&&s>2,prev:!r&&s>1,next:!r&&s<l,last:!r&&s<l-1};j.push(m(".entry-list__footer",m(Button,{class:"entry-list__footer__back-button",iconOnly:!1,caption:i18n("Go back"),onclick(){y()}}),m(".entry-list__footer__spacer"),m(Button,mergeObject(t,{icon:"fa-angle-double-left",caption:i18n("First page"),enabled:e.first,onclick(){g(1)}})),m(Button,mergeObject(t,{icon:"fa-angle-left",caption:i18n("Previous page"),enabled:e.prev,onclick(){g(s-1)}})),m("p.entry-list__footer__page",`${s} / ${l}`),m(Button,mergeObject(t,{icon:"fa-angle-right",caption:i18n("Next page"),enabled:e.next,onclick(){g(s+1)}})),m(Button,mergeObject(t,{icon:"fa-angle-double-right",caption:i18n("Last page"),enabled:e.last,onclick(){g(l)}}))))}return m(".entry-list",{class:c},b,O,...j)}}}